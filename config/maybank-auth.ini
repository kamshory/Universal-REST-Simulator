PATH=/universal-simulator/maybank/auth

METHOD=POST

REQUEST_TYPE=application/x-www-form-urlencoded

RESPONSE_TYPE=application/json

PARSING_RULE=\
$INPUT.USERNAME=$AUTHORIZATION_BASIC.USERNAME\
$INPUT.PASSWORD=$AUTHORIZATION_BASIC.PASSWORD\
$INPUT.GRANT_TYPE=$POST.grant_type\
$INPUT.UUID1=$SYSTEM.UUID\
$INPUT.UUID2=$SYSTEM.UUID\
$INPUT.UUID3=$SYSTEM.UUID\
$INPUT.UUID4=$SYSTEM.UUID

TRANSACTION_RULE=\
{[IF]} ($INPUT.GRANT_TYPE == 'client_credentials' && $INPUT.USERNAME == "username" && $INPUT.PASSWORD == "password")\
{[THEN]} $OUTPUT.DELAY=0\
$OUTPUT.DELAY=0\
$OUTPUT.BODY={\
	"token_type": "Bearer",\
	"access_token": "$INPUT.UUID1$INPUT.UUID2$INPUT.UUID3$INPUT.UUID4",\
	"expires_in": 3600,\
	"email": "token@domain.tld",\
	"expire_at": $DATE('U', 'UTC')\
}\
{[ENDIF]}\
{[IF]} (true)\
{[THEN]}\
$OUTPUT.DELAY=0\
$OUTPUT.BODY={\
	"token_type": "Bearer",\
	"access_token": "$INPUT.UUID1$INPUT.UUID2$INPUT.UUID3$INPUT.UUID4",\
	"expires_in": 3600,\
	"email": "token@domain.tld",\
	"expire_at": $DATE('U', 'UTC')\
}\
{[ENDIF]}\
